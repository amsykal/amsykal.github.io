<!DOCTYPE html>
	<html>
		<head>
			<title>Kadane's Algorithm to Solve the Maximum Sum Subarray Problem</title>
			<!-- link to main stylesheet -->
			<link rel="stylesheet" type="text/css" href="/css/main.css">
			<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$']],
      processEscapes: true
    }
  });
</script>
			<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
		</head>
		<body>
			<nav>
	    		<ul>
	        		<li><a href="/">About</a></li>
	        		<li><a href="/blog/">Blog</a></li>
	    		</ul>
			</nav>
			<div class="container">

			<h1>Kadane's Algorithm to Solve the Maximum Sum Subarray Problem</h1>
<p class="meta">31 Dec 2020</p>

<div class="post">
  <h4 id="problem">PROBLEM</h4>

<p><a href="https://projecteuler.net/problem=149">Problem</a></p>

<p>Given a matrix with entries generated by a pseudorandom generator function, find the subarray made of contiguous entries with  maximum sum along any direction.</p>

<hr />

<p>One way to solve this problem is to make 1D arrays out of each horizontal row, vertical column, left diagonal elements and right diagonal elements.</p>

<p>Then for each of these arrays we find the largest subarray with maximal sum. And finally the maximum among these gives the solution.</p>

<hr />
<p><strong>STEP 1</strong></p>

<p>This step takes a matrix and generates all possible 1D arrays along the row, column and diagonals.</p>

<p>Below is a partial python snippet to do this.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def f(g):
	gt = list(zip(*g))
	for i in range(SIZE):
			# left to right top half
			d1= []
			# left to right bottom half
			d2 = []
			# right to left top half
			d3 = []
			# right to left bottom half
			d4 = []
			# row
			d5 = g[i]
			# column
			d6 = gt[i]

			for x in range(0,SIZE-i):
				d1.append(g[x][x+i])
				d2.append(g[x+i][x])
				d3.append(g[x][SIZE-x-i-1])
				d4.append(g[x+i][SIZE-x-1])


</code></pre></div></div>

<p>Consider the 4 by 4 2d array(list) g below along with row and column numbers.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">r/c</th>
      <th style="text-align: left">0</th>
      <th style="text-align: left">1</th>
      <th style="text-align: left">2</th>
      <th style="text-align: left">3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">0</td>
      <td style="text-align: left">−2</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">3</td>
      <td style="text-align: left">2</td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">9</td>
      <td style="text-align: left">−6</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">3</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">7</td>
      <td style="text-align: left">3</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">−1</td>
      <td style="text-align: left">8</td>
      <td style="text-align: left">−4</td>
      <td style="text-align: left">8</td>
    </tr>
  </tbody>
</table>

<p>d5 gives us the rows like [-2,5,3,2], [9,-6,5,1] etc</p>

<p>d6 gives us the columns like [-2,9,3,-1], [5,-6,2,8] etc</p>

<p>d1 gives the top half of left to right diagonal like [2], [3,1], [5,5,3]</p>

<p>d2 gives the bottom half of left to right diagonal like [-1], [3,8], [9,2,-4]</p>

<p>d3 gives the top half of right to left diagonal like [-2], [5,9], [3,-6, 3]</p>

<p>d4 gives the bottom half of right to left diagonal like [8], [3,-4], [1,7,8]</p>

<hr />

<p><strong>STEP 2</strong></p>

<p>The largest subarray sum problem can be stated formally as follows</p>

<p>Given an array of integers , $A = [a_0,a_1,….a_{n-1}]$ , find a subarray $A[a_l,….a_r]$ such that $\sum_{i=l}^{r} A[i]$ is maximum</p>

<p><strong>Example</strong></p>

<p>The maximum sum subarray in A = [-2, 4, 2, -3, 1] is a = [4,2] with sum = 6</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">index</th>
      <th style="text-align: left">0</th>
      <th style="text-align: left">1</th>
      <th style="text-align: left">2</th>
      <th style="text-align: left">3</th>
      <th style="text-align: left">4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">elements</td>
      <td style="text-align: left">-2</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left">1</td>
    </tr>
  </tbody>
</table>

<p>One way to solve this problem is through brute force. Find every possible subarray and the corresponding sum. Find the maximum among these.</p>

<p>We will have 15 possible subarrays for this problem listed as below.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">start index</th>
      <th style="text-align: left">0</th>
      <th style="text-align: left">1</th>
      <th style="text-align: left">2</th>
      <th style="text-align: left">3</th>
      <th style="text-align: left">4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">0</td>
      <td style="text-align: left">-2</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">0</td>
      <td style="text-align: left">-2</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">0</td>
      <td style="text-align: left">-2</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">0</td>
      <td style="text-align: left">-2</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">0</td>
      <td style="text-align: left">-2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
    </tr>
  </tbody>
</table>

<p>As we can see, starting from index 0 we have 5 possible subarrays, from index 1 there are 4 possible subarrays and so on.</p>

<p>For an array of length n, there are n*(n+1)/2 possibilities.</p>

<p>So the brute force solution can be solved in $O(n^2)$ time.</p>

<hr />

<p><a href="https://en.wikipedia.org/wiki/Maximum_subarray_problem">Jay Kadane</a> proposed an algorithm to solve the problem in $O(n)$ time.</p>

<p>Going back to the example, Kadane’s algorithm uses the idea of a local and global maximum.</p>

<p>Local maximum is the maximum for all subarrays formed with element at index i as the last element.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">start index</th>
      <th style="text-align: left">0</th>
      <th style="text-align: left">1</th>
      <th style="text-align: left">2</th>
      <th style="text-align: left">3</th>
      <th style="text-align: left">4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">elements</td>
      <td style="text-align: left">-2</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left">1</td>
    </tr>
  </tbody>
</table>

<p>If we list all subarrays with index 2 as the last element, we get</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">0</th>
      <th style="text-align: left">1</th>
      <th style="text-align: left">2</th>
      <th style="text-align: left">3</th>
      <th style="text-align: left">4</th>
      <th style="text-align: left">sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">-2</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">4</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">6</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">2</td>
    </tr>
  </tbody>
</table>

<p>So the local maximum for index 2 is 6 corresponding to subarray [4,2]</p>

<p>Below is the table for local maximums for all indices</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">ending index</th>
      <th style="text-align: left">0</th>
      <th style="text-align: left">1</th>
      <th style="text-align: left">2</th>
      <th style="text-align: left">3</th>
      <th style="text-align: left">4</th>
      <th style="text-align: left">local max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">0</td>
      <td style="text-align: left">-2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">2</td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">4</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">4</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">6</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">3</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left"> </td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">-3</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">4</td>
    </tr>
  </tbody>
</table>

<p>A look at the table above tells us 6 is the global maximum and the corresponding subarray [4,2] is the longest subarray.</p>

<p>The way Kadane’s algorithm implemented in Python is as below.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def kadane(x):
    max_local = x[0]
    max_global = x[0]
    for i in range(1,len(x)):
        max_local = max(x[i],max_local+x[i])
        if max_local &gt; max_global:
            max_global = max_local
    return max_global
</code></pre></div></div>

<hr />
<p><strong>EXAMPLE 1</strong></p>

<p>Consider another example for a code walkthrough.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">index</th>
      <th style="text-align: left">0</th>
      <th style="text-align: left">1</th>
      <th style="text-align: left">2</th>
      <th style="text-align: left">3</th>
      <th style="text-align: left">4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">elements</td>
      <td style="text-align: left">3</td>
      <td style="text-align: left">-1</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">9</td>
      <td style="text-align: left">-7</td>
      <td>2</td>
    </tr>
  </tbody>
</table>

<p>max_local = x[0] = 3
max_global = x[0] = 3</p>

<p><strong>ITERATIONS</strong></p>

<p><strong>i = 1</strong></p>

<p>max_local = max(x[1],max_local+x[1]) = max(-1,2) = 2</p>

<p>max_local &lt; max_global</p>

<p>So max_global = 3</p>

<p><strong>i = 2</strong></p>

<p>max_local = max(x[2],max_local+x[2]) = max(5,7) = 7</p>

<p>max_local &gt; max_global</p>

<p>So max_global = 7</p>

<p><strong>i = 3</strong></p>

<p>max_local = max(x[3],max_local+x[3]) = max(9,16) = 16</p>

<p>max_local &gt; max_global</p>

<p>So max_global = 16</p>

<p><strong>i = 4</strong></p>

<p>max_local = max(x[4],max_local+x[4]) = max(-7,9) = 9</p>

<p>max_local &lt; max_global</p>

<p>So max_global = 16</p>

<p><strong>i = 5</strong></p>

<p>max_local = max(x[5],max_local+x[5]) = max(2,11) = 11</p>

<p>max_local &lt; max_global</p>

<p>So max_global = 16</p>

<p>This gives a global maximum of 16 corresponding to the subarray 3,-1,5,9</p>

<hr />

<p><strong>EXAMPLE 2</strong></p>

<p>max_local = x[0] = 3
max_global = x[0] = 3</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">index</th>
      <th style="text-align: left">0</th>
      <th style="text-align: left">1</th>
      <th style="text-align: left">2</th>
      <th style="text-align: left">3</th>
      <th style="text-align: left">4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">elements</td>
      <td style="text-align: left">3</td>
      <td style="text-align: left">-4</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">5</td>
      <td style="text-align: left">-6</td>
      <td>2</td>
    </tr>
  </tbody>
</table>

<p><strong>ITERATIONS</strong></p>

<p><strong>i = 1</strong></p>

<p>max_local = max(x[1],max_local+x[1]) = max(-4,-1) = -1</p>

<p>max_local &lt; max_global</p>

<p>So max_global = 3</p>

<p><strong>i = 2</strong></p>

<p>max_local = max(x[2],max_local+x[2]) = max(1,0) = 1</p>

<p>max_local &lt; max_global</p>

<p>So max_global = 3</p>

<p><strong>i = 3</strong>
max_local = max(x[3],max_local+x[3]) = max(5,6) = 6
max_local &gt; max_global</p>

<p>So max_global = 6</p>

<p><strong>i = 4</strong></p>

<p>max_local = max(x[4],max_local+x[4]) = max(-6,0) = 0</p>

<p>max_local &lt; max_global</p>

<p>So max_global = 6</p>

<p><strong>i = 5</strong></p>

<p>max_local = max(x[5],max_local+x[5]) = max(2,2) = 2</p>

<p>max_local &lt; max_global</p>

<p>So max_global = 6</p>

<p>This gives a global maximum of 6 corresponding to the subarray [1,5]</p>

<hr />

<p><strong>STEP 3</strong></p>

<p>All that’s left to do is to run the 1D arrays obtained from STEP 1 and run the Kadane’s algorithm on each of them and get the maximum sum for each list. The maximum of these maximums gives the final solution.</p>

<hr />

</div>


    </div><!-- /.container -->

		<footer>
        <ul>
            <li><a href="mailto:amsy.kal@gmail.com">email</a></li>
      </ul>
    </footer>
  </body>
</html>
